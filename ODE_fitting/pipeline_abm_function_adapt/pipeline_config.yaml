# =============================================================================
# Pipeline configuration (ABM sweep + multi-model ODE fitting)
# =============================================================================

# Where a timestamped run folder will be created
results_root: "pipeline_results"

# -----------------------------------------------------------------------------
# ABM defaults (applies to all scenarios unless a scenario overrides something)
# -----------------------------------------------------------------------------
abm:
  # NOTE: start_step is now inferred from the scenario "mode"
  # (71 for data_t71_phase2, else 1)
  n_runs: 100
  n_workers: 8
  seed: 42
  defaults_yaml: "scripts/scripts_defaults.yaml"
  background_dir: "background"

# -----------------------------------------------------------------------------
# ABM scenarios to run (edit/extend this list to sweep modes and parameters)
#   MODES:
#     - data_t71_phase2
#     - singletons_phase2_fit71plus
#     - singletons_phase2_fit_all
#     - singletons_phase1_to_2_fit71plus
#     - singletons_phase1_to_2_fit_all
#   PARAMETERS (optional per scenario):
#     - initial_singleton_count: <int>
#     - phase1_duration: <int> (for phase1_to_2 modes; informational)
# -----------------------------------------------------------------------------
abm_sweep:
  # (1) Current run: data-informed IC at t=71, Phase-2 only, fit ≥ 71
  - mode: data_t71_phase2
    abm_params: {}

  # (2) t=1 singletons, Phase-2 only, fit ≥ 71
  - mode: singletons_phase2_fit71plus
    abm_params:
      initial_singleton_count: 800

  # (3) t=1 singletons, Phase-2 only, fit all timepoints
  - mode: singletons_phase2_fit_all
    abm_params:
      initial_singleton_count: 800

  # (4) t=1 singletons, Phase-1 → 2 transitions, fit ≥ 71
  - mode: singletons_phase1_to_2_fit71plus
    abm_params:
      initial_singleton_count: 800

  # (5) t=1 singletons, Phase-1 → 2 transitions, fit all timepoints
  - mode: singletons_phase1_to_2_fit_all
    abm_params:
      initial_singleton_count: 800

# -----------------------------------------------------------------------------
# MCMC settings (diagnostics & PPC; AIC comes from MLE stage)
# (Preserved from your current file)
# -----------------------------------------------------------------------------
mcmc:
  chunk: 10000
  print_every: 2000
  rhat_threshold: 1.05
  max_total_iters: 200000
  burn_in_fraction: 0.5
  nsamples_ppc: 300
  random_seed: 123

# -----------------------------------------------------------------------------
# ODE model list (all 16 variants preserved from your current file)
# -----------------------------------------------------------------------------
models:
  # - no_prolif_no_shed
  # - no_prolif_cst_shed
  # - no_prolif_SA_shed
  # - no_prolif_Cell_num_shed
  # - cst_prolif_no_shed
  # - cst_prolif_cst_shed
  # - cst_prolif_SA_shed
  # - cst_prolif_Cell_num_shed
  # - SA_prolif_no_shed
  # - SA_prolif_cst_shed
  # - SA_prolif_SA_shed
  # - SA_prolif_Cell_num_shed
  - Cell_num_prolif_no_shed
  - Cell_num_prolif_cst_shed
  # - Cell_num_prolif_SA_shed
  # - Cell_num_prolif_Cell_num_shed

# -----------------------------------------------------------------------------
# Per-model metadata (names / priors / initials) — preserved
# -----------------------------------------------------------------------------
models_meta:
  # ────────────────────────────────────────────────────────────────
  # No proliferation
  # ────────────────────────────────────────────────────────────────
  no_prolif_no_shed:
    param_names: ["b", "N_0"]
    priors: [[0.0, 1.0e-2], [1.0, 4000.0]]
    initial: [3.0e-4, 900.0]

  no_prolif_cst_shed:
    param_names: ["b", "s", "N_0"]
    priors: [[0.0, 1.0e-2], [0.0, 1.0e-1], [1.0, 4000.0]]
    initial: [3.0e-4, 1.0e-4, 900.0]

  no_prolif_SA_shed:
    param_names: ["b", "s", "N_0"]  # 's' acts with √size weighting in the model code
    priors: [[0.0, 1.0e-2], [0.0, 1.0e-1], [1.0, 4000.0]]
    initial: [3.0e-4, 1.0e-4, 900.0]

  no_prolif_Cell_num_shed:
    param_names: ["b", "s", "N_0"]  # 's' scales with cluster size in shedding
    priors: [[0.0, 1.0e-2], [0.0, 1.0e-1], [1.0, 4000.0]]
    initial: [3.0e-4, 1.0e-4, 900.0]

  # ────────────────────────────────────────────────────────────────
  # Constant-rate proliferation (p), various shedding
  # ────────────────────────────────────────────────────────────────
  cst_prolif_no_shed:
    param_names: ["b", "p", "N_0"]
    priors: [[0.0, 1.0e-2], [0.0, 5.0e-2], [1.0, 4000.0]]
    initial: [3.0e-4, 1.0e-3, 900.0]

  cst_prolif_cst_shed:
    param_names: ["b", "p", "s", "N_0"]
    priors: [[0.0, 1.0e-2], [0.0, 5.0e-2], [0.0, 1.0e-1], [1.0, 4000.0]]
    initial: [3.0e-4, 1.0e-3, 1.0e-4, 900.0]

  cst_prolif_SA_shed:
    param_names: ["b", "p", "s", "N_0"]
    priors: [[0.0, 1.0e-2], [0.0, 5.0e-2], [0.0, 1.0e-1], [1.0, 4000.0]]
    initial: [3.0e-4, 1.0e-3, 1.0e-4, 900.0]

  cst_prolif_Cell_num_shed:
    param_names: ["b", "p", "s", "N_0"]
    priors: [[0.0, 1.0e-2], [0.0, 5.0e-2], [0.0, 1.0e-1], [1.0, 4000.0]]
    initial: [3.0e-4, 1.0e-3, 1.0e-4, 900.0]

  # ────────────────────────────────────────────────────────────────
  # Surface-area–weighted proliferation (SA_prolif), various shedding
  # ────────────────────────────────────────────────────────────────
  SA_prolif_no_shed:
    param_names: ["b", "p", "N_0"]  # p acts with √size weighting in proliferation
    priors: [[0.0, 1.0e-2], [0.0, 5.0e-2], [1.0, 4000.0]]
    initial: [3.0e-4, 1.0e-3, 900.0]

  SA_prolif_cst_shed:
    param_names: ["b", "p", "s", "N_0"]
    priors: [[0.0, 1.0e-2], [0.0, 5.0e-2], [0.0, 1.0e-1], [1.0, 4000.0]]
    initial: [3.0e-4, 1.0e-3, 1.0e-4, 900.0]

  SA_prolif_SA_shed:
    param_names: ["b", "p", "s", "N_0"]
    priors: [[0.0, 1.0e-2], [0.0, 5.0e-2], [0.0, 1.0e-1], [1.0, 4000.0]]
    initial: [3.0e-4, 1.0e-3, 1.0e-4, 900.0]

  SA_prolif_Cell_num_shed:
    param_names: ["b", "p", "s", "N_0"]
    priors: [[0.0, 1.0e-2], [0.0, 5.0e-2], [0.0, 1.0e-1], [1.0, 4000.0]]
    initial: [3.0e-4, 1.0e-3, 1.0e-4, 900.0]

  # ────────────────────────────────────────────────────────────────
  # Cell-number–weighted proliferation (Cell_num_prolif), various shedding
  # ────────────────────────────────────────────────────────────────
  Cell_num_prolif_no_shed:
    param_names: ["b", "p", "N_0"]
    priors: [[0.0, 1.0e-2], [0.0, 5.0e-2], [1.0, 4000.0]]
    initial: [4.0e-4, 1.0e-2, 500.0]  # aligns with suggested values in your code

  Cell_num_prolif_cst_shed:
    param_names: ["b", "p", "s", "N_0"]
    priors: [[0.0, 1.0e-2], [0.0, 5.0e-2], [0.0, 1.0e-1], [1.0, 4000.0]]
    initial: [3.0e-4, 1.0e-3, 1.0e-4, 900.0]

  Cell_num_prolif_SA_shed:
    param_names: ["b", "p", "s", "N_0"]
    priors: [[0.0, 1.0e-2], [0.0, 5.0e-2], [0.0, 1.0e-1], [1.0, 4000.0]]
    initial: [3.0e-4, 1.0e-3, 1.0e-4, 900.0]

  Cell_num_prolif_Cell_num_shed:
    param_names: ["b", "p", "s", "N_0"]
    priors: [[0.0, 1.0e-2], [0.0, 5.0e-2], [0.0, 1.0e-1], [1.0, 4000.0]]
    initial: [3.0e-4, 1.0e-3, 1.0e-4, 900.0]